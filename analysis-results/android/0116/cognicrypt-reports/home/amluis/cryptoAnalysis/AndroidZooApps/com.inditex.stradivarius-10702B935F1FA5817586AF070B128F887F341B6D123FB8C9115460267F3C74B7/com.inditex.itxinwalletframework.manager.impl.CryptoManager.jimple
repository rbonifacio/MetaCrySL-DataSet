public class com.inditex.itxinwalletframework.manager.impl.CryptoManager extends java.lang.Object implements com.inditex.itxinwalletframework.manager.ICryptoManager
{

    public void <init>()
    {
        com.inditex.itxinwalletframework.manager.impl.CryptoManager $r0;

        nop;

        $r0 := @this: com.inditex.itxinwalletframework.manager.impl.CryptoManager;

        specialinvoke $r0.<java.lang.Object: void <init>()>();

        return;
    }

    public byte[] generateDatabaseKey()
    {
        com.inditex.itxinwalletframework.manager.impl.CryptoManager $r0;
        byte[] $r1;
        java.security.SecureRandom $r2;

        nop;

        $r0 := @this: com.inditex.itxinwalletframework.manager.impl.CryptoManager;

        $r1 = newarray (byte)[64];

        $r2 = new java.security.SecureRandom;

        specialinvoke $r2.<java.security.SecureRandom: void <init>()>();

        virtualinvoke $r2.<java.security.SecureRandom: void nextBytes(byte[])>($r1);

        return $r1;
    }

    public java.security.KeyPair generateKeyPairKeys()
    {
        com.inditex.itxinwalletframework.manager.impl.CryptoManager $r0;
        java.lang.Throwable $r1;
        java.security.KeyPairGenerator $r2;
        java.security.KeyPair $r3;
        null_type varReplacer13727;
        java.lang.String varReplacer13728, varReplacer13730, varReplacer13731;
        int varReplacer13729;

        nop;

        $r0 := @this: com.inditex.itxinwalletframework.manager.impl.CryptoManager;

     label1:
        varReplacer13728 = "RSA";

        $r2 = staticinvoke <java.security.KeyPairGenerator: java.security.KeyPairGenerator getInstance(java.lang.String)>(varReplacer13728);

        varReplacer13729 = 1024;

        virtualinvoke $r2.<java.security.KeyPairGenerator: void initialize(int)>(varReplacer13729);

        $r3 = virtualinvoke $r2.<java.security.KeyPairGenerator: java.security.KeyPair generateKeyPair()>();

     label2:
        return $r3;

     label3:
        $r1 := @caughtexception;

        varReplacer13730 = "CryptoManager";

        varReplacer13731 = "Error generating KeyPairKeys";

        staticinvoke <com.inditex.itxinwalletframework.utils.Log: void e(java.lang.String,java.lang.String)>(varReplacer13730, varReplacer13731);

        varReplacer13727 = null;

        return varReplacer13727;

        catch java.security.GeneralSecurityException from label1 to label2 with label3;
    }

    public byte[] getPrivateKeyAsByteArray(java.security.KeyPair)
    {
        com.inditex.itxinwalletframework.manager.impl.CryptoManager $r0;
        java.security.KeyPair $r1;
        java.security.PrivateKey $r2;
        byte[] $r3;

        nop;

        $r0 := @this: com.inditex.itxinwalletframework.manager.impl.CryptoManager;

        $r1 := @parameter0: java.security.KeyPair;

        $r2 = virtualinvoke $r1.<java.security.KeyPair: java.security.PrivateKey getPrivate()>();

        $r3 = interfaceinvoke $r2.<java.security.PrivateKey: byte[] getEncoded()>();

        return $r3;
    }

    public java.security.PrivateKey getPrivateKeyFromByteArray(byte[])
    {
        com.inditex.itxinwalletframework.manager.impl.CryptoManager $r0;
        byte[] $r1;
        java.security.spec.PKCS8EncodedKeySpec $r2, r7;
        java.security.KeyFactory $r3;
        java.security.PrivateKey $r4;
        java.lang.Throwable $r5, $r6;
        java.security.spec.InvalidKeySpecException r8;
        java.security.NoSuchAlgorithmException r9;
        null_type varReplacer13822, varReplacer13823;
        java.lang.String varReplacer13824;

        nop;

        $r0 := @this: com.inditex.itxinwalletframework.manager.impl.CryptoManager;

        $r1 := @parameter0: byte[];

     label1:
        varReplacer13824 = "RSA";

        $r3 = staticinvoke <java.security.KeyFactory: java.security.KeyFactory getInstance(java.lang.String)>(varReplacer13824);

     label2:
        r7 = new java.security.spec.PKCS8EncodedKeySpec;

        $r2 = r7;

     label3:
        specialinvoke r7.<java.security.spec.PKCS8EncodedKeySpec: void <init>(byte[])>($r1);

        $r4 = virtualinvoke $r3.<java.security.KeyFactory: java.security.PrivateKey generatePrivate(java.security.spec.KeySpec)>($r2);

     label4:
        return $r4;

     label5:
        $r5 := @caughtexception;

        r8 = (java.security.spec.InvalidKeySpecException) $r5;

        virtualinvoke r8.<java.security.spec.InvalidKeySpecException: void printStackTrace()>();

        varReplacer13822 = null;

        return varReplacer13822;

     label6:
        $r6 := @caughtexception;

        r9 = (java.security.NoSuchAlgorithmException) $r6;

        virtualinvoke r9.<java.security.NoSuchAlgorithmException: void printStackTrace()>();

        varReplacer13823 = null;

        return varReplacer13823;

        catch java.security.spec.InvalidKeySpecException from label1 to label2 with label5;
        catch java.security.spec.InvalidKeySpecException from label3 to label4 with label5;
        catch java.security.NoSuchAlgorithmException from label1 to label2 with label6;
        catch java.security.NoSuchAlgorithmException from label3 to label4 with label6;
    }

    public java.lang.String getPublicKeyAsBase64(java.security.KeyPair)
    {
        com.inditex.itxinwalletframework.manager.impl.CryptoManager $r0;
        java.security.KeyPair $r1;
        java.security.PublicKey $r2;
        byte[] $r3;
        java.lang.String $r4;
        int varReplacer13732;

        nop;

        $r0 := @this: com.inditex.itxinwalletframework.manager.impl.CryptoManager;

        $r1 := @parameter0: java.security.KeyPair;

        $r2 = virtualinvoke $r1.<java.security.KeyPair: java.security.PublicKey getPublic()>();

        $r3 = interfaceinvoke $r2.<java.security.PublicKey: byte[] getEncoded()>();

        varReplacer13732 = 2;

        $r4 = staticinvoke <android.util.Base64: java.lang.String encodeToString(byte[],int)>($r3, varReplacer13732);

        return $r4;
    }

    public byte[] signData(byte[], java.security.PrivateKey)
    {
        com.inditex.itxinwalletframework.manager.impl.CryptoManager $r0;
        byte[] $r1, $r3;
        java.security.PrivateKey $r2;
        java.security.Signature $r4;
        java.lang.Throwable $r5, $r6, $r7;
        java.lang.String varReplacer13825, varReplacer13826, varReplacer13827, varReplacer13828, varReplacer13829, varReplacer13830, varReplacer13831;

        nop;

        $r0 := @this: com.inditex.itxinwalletframework.manager.impl.CryptoManager;

        $r1 := @parameter0: byte[];

        $r2 := @parameter1: java.security.PrivateKey;

        $r3 = newarray (byte)[0];

     label1:
        varReplacer13825 = "SHA256withRSA";

        $r4 = staticinvoke <java.security.Signature: java.security.Signature getInstance(java.lang.String)>(varReplacer13825);

        virtualinvoke $r4.<java.security.Signature: void initSign(java.security.PrivateKey)>($r2);

        virtualinvoke $r4.<java.security.Signature: void update(byte[])>($r1);

        $r1 = virtualinvoke $r4.<java.security.Signature: byte[] sign()>();

     label2:
        return $r1;

     label3:
        $r5 := @caughtexception;

        varReplacer13830 = "CryptoManager";

        varReplacer13831 = "Error signing data";

        staticinvoke <com.inditex.itxinwalletframework.utils.Log: void e(java.lang.String,java.lang.String)>(varReplacer13830, varReplacer13831);

        return $r3;

     label4:
        $r6 := @caughtexception;

        varReplacer13826 = "CryptoManager";

        varReplacer13827 = "Error signing data";

        staticinvoke <com.inditex.itxinwalletframework.utils.Log: void e(java.lang.String,java.lang.String)>(varReplacer13826, varReplacer13827);

        return $r3;

     label5:
        $r7 := @caughtexception;

        varReplacer13828 = "CryptoManager";

        varReplacer13829 = "Error signing data";

        staticinvoke <com.inditex.itxinwalletframework.utils.Log: void e(java.lang.String,java.lang.String)>(varReplacer13828, varReplacer13829);

        return $r3;

        catch java.security.NoSuchAlgorithmException from label1 to label2 with label3;
        catch java.security.InvalidKeyException from label1 to label2 with label4;
        catch java.security.SignatureException from label1 to label2 with label5;
    }

    public boolean verifyData(byte[], byte[], java.security.PublicKey)
    {
        com.inditex.itxinwalletframework.manager.impl.CryptoManager $r0;
        byte[] $r1, $r2;
        java.security.PublicKey $r3;
        java.security.Signature $r4;
        boolean $z0;
        java.lang.Throwable $r5, $r6, $r7;

        $r0 := @this: com.inditex.itxinwalletframework.manager.impl.CryptoManager;

        $r1 := @parameter0: byte[];

        $r2 := @parameter1: byte[];

        $r3 := @parameter2: java.security.PublicKey;

     label1:
        $r4 = staticinvoke <java.security.Signature: java.security.Signature getInstance(java.lang.String)>("SHA256withRSA");

        virtualinvoke $r4.<java.security.Signature: void initVerify(java.security.PublicKey)>($r3);

        virtualinvoke $r4.<java.security.Signature: void update(byte[])>($r1);

        $z0 = virtualinvoke $r4.<java.security.Signature: boolean verify(byte[])>($r2);

     label2:
        return $z0;

     label3:
        $r5 := @caughtexception;

        staticinvoke <com.inditex.itxinwalletframework.utils.Log: void e(java.lang.String,java.lang.String)>("CryptoManager", "Error verifyng signed data");

        return 0;

     label4:
        $r6 := @caughtexception;

        staticinvoke <com.inditex.itxinwalletframework.utils.Log: void e(java.lang.String,java.lang.String)>("CryptoManager", "Error verifyng signed data");

        return 0;

     label5:
        $r7 := @caughtexception;

        staticinvoke <com.inditex.itxinwalletframework.utils.Log: void e(java.lang.String,java.lang.String)>("CryptoManager", "Error verifyng signed data");

        return 0;

        catch java.security.NoSuchAlgorithmException from label1 to label2 with label3;
        catch java.security.SignatureException from label1 to label2 with label4;
        catch java.security.InvalidKeyException from label1 to label2 with label5;
    }
}
