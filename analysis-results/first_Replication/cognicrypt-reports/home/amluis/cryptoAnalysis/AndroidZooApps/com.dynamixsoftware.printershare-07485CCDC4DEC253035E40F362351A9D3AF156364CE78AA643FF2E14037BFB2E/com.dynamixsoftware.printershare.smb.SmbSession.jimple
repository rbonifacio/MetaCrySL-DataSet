final class com.dynamixsoftware.printershare.smb.SmbSession extends java.lang.Object
{
    private static final java.lang.String LOGON_SHARE;
    private com.dynamixsoftware.printershare.smb.UniAddress address;
    com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth;
    private int connectionState;
    long expiration;
    private java.net.InetAddress localAddr;
    private int localPort;
    private java.lang.String netbiosName;
    private int port;
    com.dynamixsoftware.printershare.smb.SmbTransport transport;
    private java.util.Vector trees;
    private int uid;

    static void <clinit>()
    {
        null_type varReplacer3082;

        nop;

        varReplacer3082 = null;

        <com.dynamixsoftware.printershare.smb.SmbSession: java.lang.String LOGON_SHARE> = varReplacer3082;

        return;
    }

    void <init>(com.dynamixsoftware.printershare.smb.UniAddress, int, java.net.InetAddress, int, com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication)
    {
        com.dynamixsoftware.printershare.smb.SmbSession $r0;
        com.dynamixsoftware.printershare.smb.UniAddress $r1;
        int $i0, $i1, varReplacer3091;
        java.net.InetAddress $r2;
        com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication $r3;
        java.util.Vector $r4;
        null_type varReplacer3092, varReplacer3093;

        nop;

        $r0 := @this: com.dynamixsoftware.printershare.smb.SmbSession;

        $r1 := @parameter0: com.dynamixsoftware.printershare.smb.UniAddress;

        $i0 := @parameter1: int;

        $r2 := @parameter2: java.net.InetAddress;

        $i1 := @parameter3: int;

        $r3 := @parameter4: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication;

        specialinvoke $r0.<java.lang.Object: void <init>()>();

        varReplacer3093 = null;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport> = varReplacer3093;

        varReplacer3092 = null;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: java.lang.String netbiosName> = varReplacer3092;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.UniAddress address> = $r1;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int port> = $i0;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: java.net.InetAddress localAddr> = $r2;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int localPort> = $i1;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth> = $r3;

        $r4 = new java.util.Vector;

        specialinvoke $r4.<java.util.Vector: void <init>()>();

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: java.util.Vector trees> = $r4;

        varReplacer3091 = 0;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int connectionState> = varReplacer3091;

        return;
    }

    private void sessionSetup(com.dynamixsoftware.printershare.smb.ServerMessageBlock, com.dynamixsoftware.printershare.smb.ServerMessageBlock) throws com.dynamixsoftware.printershare.smb.SmbException
    {
        com.dynamixsoftware.printershare.smb.SmbSession $r0, $r19;
        com.dynamixsoftware.printershare.smb.ServerMessageBlock $r1, $r2;
        java.lang.Throwable $r3, $r11, $r14, $r31;
        com.dynamixsoftware.printershare.smb.NtlmContext $r4, $r6;
        com.dynamixsoftware.printershare.smb.SmbTransport $r5, $r9;
        com.dynamixsoftware.printershare.smb.SmbException $r7, $r13, $r26, $r27, $r29;
        byte[] $r8, $r24;
        byte $b0;
        int $i1, varReplacer3138, varReplacer3139, varReplacer3140, varReplacer3142, varReplacer3143, varReplacer3146, varReplacer3147, varReplacer3149, varReplacer3150, varReplacer3151, varReplacer3153, varReplacer3154, varReplacer3155, varReplacer3156, varReplacer3157, varReplacer3158;
        java.lang.String $r10, $r21, varReplacer3148;
        java.lang.StringBuilder $r12, r32;
        com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication $r15, $r16;
        boolean $z0;
        com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndX $r17, r33;
        com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndXResponse $r18, r34;
        com.dynamixsoftware.printershare.smb.SmbTree $r20;
        com.dynamixsoftware.printershare.smb.SmbTransport$ServerData $r22;
        com.dynamixsoftware.printershare.smb.SmbAuthException $r23, $r28;
        com.dynamixsoftware.printershare.smb.SigningDigest $r25, r35;
        java.lang.Exception $r30;
        java.lang.InterruptedException r36;
        null_type varReplacer3141, varReplacer3144, varReplacer3145, varReplacer3152, varReplacer3159;

        nop;

        $r0 := @this: com.dynamixsoftware.printershare.smb.SmbSession;

        $r1 := @parameter0: com.dynamixsoftware.printershare.smb.ServerMessageBlock;

        $r2 := @parameter1: com.dynamixsoftware.printershare.smb.ServerMessageBlock;

        $r5 = virtualinvoke $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport()>();

        entermonitor $r5;

        $r6 = null;

        $r7 = null;

     label001:
        $r8 = newarray (byte)[0];

        $b0 = 10;

     label002:
        $i1 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int connectionState>;

        if $i1 == 0 goto label012;

        $i1 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int connectionState>;

        if $i1 == 2 goto label003;

        $i1 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int connectionState>;

        if $i1 != 3 goto label005;

     label003:
        exitmonitor $r5;

     label004:
        return;

     label005:
        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

     label006:
        virtualinvoke $r9.<java.lang.Object: void wait()>();

     label007:
        goto label002;

     label008:
        $r3 := @caughtexception;

     label009:
        $r26 = new com.dynamixsoftware.printershare.smb.SmbException;

        r36 = (java.lang.InterruptedException) $r3;

        $r10 = virtualinvoke r36.<java.lang.InterruptedException: java.lang.String getMessage()>();

        specialinvoke $r26.<com.dynamixsoftware.printershare.smb.SmbException: void <init>(java.lang.String,java.lang.Throwable)>($r10, $r3);

        throw $r26;

     label010:
        $r11 := @caughtexception;

        exitmonitor $r5;

     label011:
        throw $r11;

     label012:
        varReplacer3142 = 1;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int connectionState> = varReplacer3142;

     label013:
        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

     label014:
        virtualinvoke $r9.<com.dynamixsoftware.printershare.smb.SmbTransport: void connect()>();

     label015:
        varReplacer3147 = 0;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int uid> = varReplacer3147;

     label016:
        $r4 = $r6;

        lookupswitch($b0)
        {
            case 10: goto label023;
            case 20: goto label059;
            default: goto label017;
        };

     label017:
        $r26 = new com.dynamixsoftware.printershare.smb.SmbException;

        $r7 = $r26;

        r32 = new java.lang.StringBuilder;

        $r12 = r32;

     label018:
        specialinvoke r32.<java.lang.StringBuilder: void <init>()>();

        varReplacer3148 = "Unexpected session setup state: ";

        $r12 = virtualinvoke $r12.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(varReplacer3148);

        $r12 = virtualinvoke $r12.<java.lang.StringBuilder: java.lang.StringBuilder append(int)>($b0);

        $r10 = virtualinvoke $r12.<java.lang.StringBuilder: java.lang.String toString()>();

        specialinvoke $r26.<com.dynamixsoftware.printershare.smb.SmbException: void <init>(java.lang.String)>($r10);

        throw $r7;

     label019:
        $r13 := @caughtexception;

     label020:
        varReplacer3149 = 1;

        virtualinvoke $r0.<com.dynamixsoftware.printershare.smb.SmbSession: void logoff(boolean)>(varReplacer3149);

        varReplacer3158 = 0;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int connectionState> = varReplacer3158;

        throw $r13;

     label021:
        $r14 := @caughtexception;

     label022:
        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

        virtualinvoke $r9.<java.lang.Object: void notifyAll()>();

        throw $r14;

     label023:
        $r15 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

        $r16 = <com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication ANONYMOUS>;

        if $r15 == $r16 goto label029;

        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

     label024:
        varReplacer3143 = -2147483648;

        $z0 = virtualinvoke $r9.<com.dynamixsoftware.printershare.smb.SmbTransport: boolean hasCapability(int)>(varReplacer3143);

     label025:
        if $z0 == 0 goto label029;

        $b0 = 20;

     label026:
        if $b0 != 0 goto label016;

     label027:
        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

        virtualinvoke $r9.<java.lang.Object: void notifyAll()>();

        exitmonitor $r5;

     label028:
        return;

     label029:
        r33 = new com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndX;

        $r17 = r33;

        $r15 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

     label030:
        specialinvoke r33.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndX: void <init>(com.dynamixsoftware.printershare.smb.SmbSession,com.dynamixsoftware.printershare.smb.ServerMessageBlock,java.lang.Object)>($r0, $r1, $r15);

     label031:
        r34 = new com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndXResponse;

        $r18 = r34;

     label032:
        specialinvoke r34.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndXResponse: void <init>(com.dynamixsoftware.printershare.smb.ServerMessageBlock)>($r2);

     label033:
        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

        $r15 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

     label034:
        $z0 = virtualinvoke $r9.<com.dynamixsoftware.printershare.smb.SmbTransport: boolean isSignatureSetupRequired(com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication)>($r15);

     label035:
        if $z0 == 0 goto label039;

        $r15 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

        $z0 = $r15.<com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication: boolean hashesExternal>;

        if $z0 == 0 goto label047;

        $r10 = <com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication: java.lang.String DEFAULT_PASSWORD>;

        if $r10 == "" goto label047;

        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

        $r15 = <com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication DEFAULT>;

     label036:
        $r19 = virtualinvoke $r9.<com.dynamixsoftware.printershare.smb.SmbTransport: com.dynamixsoftware.printershare.smb.SmbSession getSmbSession(com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication)>($r15);

     label037:
        $r10 = <com.dynamixsoftware.printershare.smb.SmbSession: java.lang.String LOGON_SHARE>;

     label038:
        varReplacer3152 = null;

        $r20 = virtualinvoke $r19.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTree getSmbTree(java.lang.String,java.lang.String)>($r10, varReplacer3152);

        varReplacer3144 = null;

        varReplacer3145 = null;

        virtualinvoke $r20.<com.dynamixsoftware.printershare.smb.SmbTree: void treeConnect(com.dynamixsoftware.printershare.smb.ServerMessageBlock,com.dynamixsoftware.printershare.smb.ServerMessageBlock)>(varReplacer3144, varReplacer3144);

     label039:
        $r15 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

        $r17.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndX: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth> = $r15;

     label040:
        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

     label041:
        virtualinvoke $r9.<com.dynamixsoftware.printershare.smb.SmbTransport: void send(com.dynamixsoftware.printershare.smb.ServerMessageBlock,com.dynamixsoftware.printershare.smb.ServerMessageBlock)>($r17, $r18);

     label042:
        $z0 = $r18.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndXResponse: boolean isLoggedInAsGuest>;

        if $z0 == 0 goto label055;

        $r10 = "GUEST";

        $r15 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

        $r21 = $r15.<com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication: java.lang.String username>;

     label043:
        $z0 = virtualinvoke $r10.<java.lang.String: boolean equalsIgnoreCase(java.lang.String)>($r21);

     label044:
        if $z0 != 0 goto label055;

        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

        $r22 = $r9.<com.dynamixsoftware.printershare.smb.SmbTransport: com.dynamixsoftware.printershare.smb.SmbTransport$ServerData server>;

        $i1 = $r22.<com.dynamixsoftware.printershare.smb.SmbTransport$ServerData: int security>;

        if $i1 == 0 goto label055;

        $r15 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

        $r16 = <com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication ANONYMOUS>;

        if $r15 == $r16 goto label055;

        $r28 = new com.dynamixsoftware.printershare.smb.SmbAuthException;

        $r23 = $r28;

     label045:
        varReplacer3153 = -1073741715;

        specialinvoke $r28.<com.dynamixsoftware.printershare.smb.SmbAuthException: void <init>(int)>(varReplacer3153);

        throw $r23;

     label046:
        $r14 := @caughtexception;

        goto label022;

     label047:
        $r15 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

        $r22 = $r9.<com.dynamixsoftware.printershare.smb.SmbTransport: com.dynamixsoftware.printershare.smb.SmbTransport$ServerData server>;

        $r24 = $r22.<com.dynamixsoftware.printershare.smb.SmbTransport$ServerData: byte[] encryptionKey>;

     label048:
        $r24 = virtualinvoke $r15.<com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication: byte[] getSigningKey(byte[])>($r24);

     label049:
        r35 = new com.dynamixsoftware.printershare.smb.SigningDigest;

     label050:
        varReplacer3140 = 0;

        specialinvoke r35.<com.dynamixsoftware.printershare.smb.SigningDigest: void <init>(byte[],boolean)>($r24, varReplacer3140);

     label051:
        $r17.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndX: com.dynamixsoftware.printershare.smb.SigningDigest digest> = r35;

        goto label039;

     label052:
        $r23 := @caughtexception;

     label053:
        throw $r23;

     label054:
        $r26 := @caughtexception;

        $r7 = $r26;

        goto label042;

     label055:
        if $r7 == null goto label057;

     label056:
        throw $r7;

     label057:
        $i1 = $r18.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndXResponse: int uid>;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int uid> = $i1;

        $r25 = $r17.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndX: com.dynamixsoftware.printershare.smb.SigningDigest digest>;

        if $r25 == null goto label058;

        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

        $r25 = $r17.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndX: com.dynamixsoftware.printershare.smb.SigningDigest digest>;

        $r9.<com.dynamixsoftware.printershare.smb.SmbTransport: com.dynamixsoftware.printershare.smb.SigningDigest digest> = $r25;

     label058:
        varReplacer3151 = 2;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int connectionState> = varReplacer3151;

        $b0 = 0;

        $r6 = $r4;

        goto label026;

     label059:
        if $r6 != null goto label107;

        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

        $i1 = $r9.<com.dynamixsoftware.printershare.smb.SmbTransport: int flags2>;

        $i1 = $i1 & 4;

        if $i1 == 0 goto label067;

        $z0 = 1;

     label060:
        $r4 = new com.dynamixsoftware.printershare.smb.NtlmContext;

        $r6 = $r4;

        $r15 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

     label061:
        specialinvoke $r4.<com.dynamixsoftware.printershare.smb.NtlmContext: void <init>(com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication,boolean)>($r15, $z0);

     label062:
        $z0 = virtualinvoke $r6.<com.dynamixsoftware.printershare.smb.NtlmContext: boolean isEstablished()>();

     label063:
        if $z0 == 0 goto label068;

     label064:
        $r10 = virtualinvoke $r6.<com.dynamixsoftware.printershare.smb.NtlmContext: java.lang.String getNetbiosName()>();

     label065:
        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: java.lang.String netbiosName> = $r10;

        varReplacer3156 = 2;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int connectionState> = varReplacer3156;

     label066:
        $b0 = 0;

        goto label026;

     label067:
        $z0 = 0;

        goto label060;

     label068:
        $i1 = lengthof $r8;

     label069:
        varReplacer3139 = 0;

        $r24 = virtualinvoke $r6.<com.dynamixsoftware.printershare.smb.NtlmContext: byte[] initSecContext(byte[],int,int)>($r8, varReplacer3139, $i1);

     label070:
        $r8 = $r24;

        if $r24 == null goto label026;

     label071:
        r33 = new com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndX;

        $r17 = r33;

     label072:
        varReplacer3141 = null;

        specialinvoke r33.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndX: void <init>(com.dynamixsoftware.printershare.smb.SmbSession,com.dynamixsoftware.printershare.smb.ServerMessageBlock,java.lang.Object)>($r0, varReplacer3141, $r24);

     label073:
        r34 = new com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndXResponse;

        $r18 = r34;

     label074:
        varReplacer3159 = null;

        specialinvoke r34.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndXResponse: void <init>(com.dynamixsoftware.printershare.smb.ServerMessageBlock)>(varReplacer3159);

     label075:
        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

        $r15 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

     label076:
        $z0 = virtualinvoke $r9.<com.dynamixsoftware.printershare.smb.SmbTransport: boolean isSignatureSetupRequired(com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication)>($r15);

     label077:
        if $z0 == 0 goto label082;

     label078:
        $r8 = virtualinvoke $r6.<com.dynamixsoftware.printershare.smb.NtlmContext: byte[] getSigningKey()>();

     label079:
        if $r8 == null goto label082;

        r35 = new com.dynamixsoftware.printershare.smb.SigningDigest;

     label080:
        varReplacer3150 = 1;

        specialinvoke r35.<com.dynamixsoftware.printershare.smb.SigningDigest: void <init>(byte[],boolean)>($r8, varReplacer3150);

     label081:
        $r17.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndX: com.dynamixsoftware.printershare.smb.SigningDigest digest> = r35;

     label082:
        $i1 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int uid>;

        $r17.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndX: int uid> = $i1;

        varReplacer3155 = 0;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int uid> = varReplacer3155;

     label083:
        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

     label084:
        virtualinvoke $r9.<com.dynamixsoftware.printershare.smb.SmbTransport: void send(com.dynamixsoftware.printershare.smb.ServerMessageBlock,com.dynamixsoftware.printershare.smb.ServerMessageBlock)>($r17, $r18);

     label085:
        $z0 = $r18.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndXResponse: boolean isLoggedInAsGuest>;

        if $z0 == 0 goto label101;

        $r10 = "GUEST";

        $r15 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

        $r21 = $r15.<com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication: java.lang.String username>;

     label086:
        $z0 = virtualinvoke $r10.<java.lang.String: boolean equalsIgnoreCase(java.lang.String)>($r21);

     label087:
        if $z0 != 0 goto label101;

        $r28 = new com.dynamixsoftware.printershare.smb.SmbAuthException;

        $r23 = $r28;

     label088:
        varReplacer3157 = -1073741715;

        specialinvoke $r28.<com.dynamixsoftware.printershare.smb.SmbAuthException: void <init>(int)>(varReplacer3157);

        throw $r23;

     label089:
        $r13 := @caughtexception;

        goto label020;

     label090:
        $r27 := @caughtexception;

     label091:
        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

     label092:
        varReplacer3146 = 1;

        virtualinvoke $r9.<com.dynamixsoftware.printershare.smb.SmbTransport: void disconnect(boolean)>(varReplacer3146);

     label093:
        varReplacer3138 = 0;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int uid> = varReplacer3138;

     label094:
        throw $r27;

     label095:
        $r28 := @caughtexception;

     label096:
        throw $r28;

     label097:
        $r29 := @caughtexception;

        $r7 = $r29;

     label098:
        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

        varReplacer3154 = 1;

        virtualinvoke $r9.<com.dynamixsoftware.printershare.smb.SmbTransport: void disconnect(boolean)>(varReplacer3154);

     label099:
        goto label085;

     label100:
        $r30 := @caughtexception;

        goto label085;

     label101:
        if $r7 == null goto label103;

     label102:
        throw $r7;

     label103:
        $i1 = $r18.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndXResponse: int uid>;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int uid> = $i1;

        $r25 = $r17.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndX: com.dynamixsoftware.printershare.smb.SigningDigest digest>;

        if $r25 == null goto label104;

        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

        $r25 = $r17.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndX: com.dynamixsoftware.printershare.smb.SigningDigest digest>;

        $r9.<com.dynamixsoftware.printershare.smb.SmbTransport: com.dynamixsoftware.printershare.smb.SigningDigest digest> = $r25;

     label104:
        $r8 = $r18.<com.dynamixsoftware.printershare.smb.SmbComSessionSetupAndXResponse: byte[] blob>;

     label105:
        goto label026;

     label106:
        $r31 := @caughtexception;

        goto label093;

     label107:
        goto label062;

        catch java.lang.Throwable from label001 to label004 with label010;
        catch java.lang.InterruptedException from label006 to label007 with label008;
        catch java.lang.Throwable from label005 to label007 with label010;
        catch java.lang.Throwable from label009 to label011 with label010;
        catch java.lang.Throwable from label012 to label013 with label010;
        catch com.dynamixsoftware.printershare.smb.SmbException from label014 to label015 with label089;
        catch java.lang.Throwable from label013 to label016 with label021;
        catch com.dynamixsoftware.printershare.smb.SmbException from label018 to label019 with label019;
        catch java.lang.Throwable from label017 to label019 with label046;
        catch java.lang.Throwable from label020 to label021 with label021;
        catch java.lang.Throwable from label022 to label023 with label010;
        catch com.dynamixsoftware.printershare.smb.SmbException from label024 to label025 with label019;
        catch java.lang.Throwable from label023 to label025 with label046;
        catch java.lang.Throwable from label027 to label028 with label010;
        catch com.dynamixsoftware.printershare.smb.SmbException from label030 to label031 with label019;
        catch com.dynamixsoftware.printershare.smb.SmbException from label032 to label033 with label019;
        catch com.dynamixsoftware.printershare.smb.SmbException from label034 to label035 with label019;
        catch com.dynamixsoftware.printershare.smb.SmbException from label036 to label037 with label019;
        catch com.dynamixsoftware.printershare.smb.SmbException from label038 to label039 with label019;
        catch java.lang.Throwable from label029 to label040 with label046;
        catch com.dynamixsoftware.printershare.smb.SmbAuthException from label041 to label042 with label052;
        catch com.dynamixsoftware.printershare.smb.SmbException from label041 to label042 with label054;
        catch java.lang.Throwable from label040 to label042 with label046;
        catch com.dynamixsoftware.printershare.smb.SmbException from label043 to label044 with label019;
        catch com.dynamixsoftware.printershare.smb.SmbException from label045 to label046 with label019;
        catch com.dynamixsoftware.printershare.smb.SmbException from label048 to label049 with label019;
        catch com.dynamixsoftware.printershare.smb.SmbException from label050 to label051 with label019;
        catch com.dynamixsoftware.printershare.smb.SmbException from label053 to label054 with label019;
        catch com.dynamixsoftware.printershare.smb.SmbException from label056 to label057 with label019;
        catch com.dynamixsoftware.printershare.smb.SmbException from label061 to label062 with label019;
        catch java.lang.Throwable from label042 to label062 with label046;
        catch com.dynamixsoftware.printershare.smb.SmbException from label062 to label063 with label089;
        catch com.dynamixsoftware.printershare.smb.SmbException from label064 to label065 with label089;
        catch java.lang.Throwable from label062 to label066 with label021;
        catch com.dynamixsoftware.printershare.smb.SmbException from label069 to label070 with label090;
        catch java.lang.Throwable from label068 to label070 with label021;
        catch com.dynamixsoftware.printershare.smb.SmbException from label072 to label073 with label089;
        catch com.dynamixsoftware.printershare.smb.SmbException from label074 to label075 with label089;
        catch com.dynamixsoftware.printershare.smb.SmbException from label076 to label077 with label089;
        catch com.dynamixsoftware.printershare.smb.SmbException from label078 to label079 with label089;
        catch com.dynamixsoftware.printershare.smb.SmbException from label080 to label081 with label089;
        catch java.lang.Throwable from label071 to label083 with label021;
        catch com.dynamixsoftware.printershare.smb.SmbAuthException from label084 to label085 with label095;
        catch com.dynamixsoftware.printershare.smb.SmbException from label084 to label085 with label097;
        catch java.lang.Throwable from label083 to label085 with label021;
        catch com.dynamixsoftware.printershare.smb.SmbException from label086 to label087 with label089;
        catch com.dynamixsoftware.printershare.smb.SmbException from label088 to label089 with label089;
        catch java.lang.Throwable from label085 to label089 with label021;
        catch java.io.IOException from label092 to label093 with label106;
        catch java.lang.Throwable from label091 to label093 with label021;
        catch com.dynamixsoftware.printershare.smb.SmbException from label094 to label095 with label089;
        catch com.dynamixsoftware.printershare.smb.SmbException from label096 to label097 with label089;
        catch java.lang.Throwable from label093 to label097 with label021;
        catch java.lang.Exception from label098 to label099 with label100;
        catch java.lang.Throwable from label098 to label099 with label021;
        catch com.dynamixsoftware.printershare.smb.SmbException from label102 to label103 with label089;
        catch java.lang.Throwable from label102 to label105 with label021;
    }

    com.dynamixsoftware.printershare.smb.SmbTree getSmbTree(java.lang.String, java.lang.String)
    {
        com.dynamixsoftware.printershare.smb.SmbSession $r0;
        java.lang.String $r1, $r2;
        java.util.Vector $r3;
        java.util.Enumeration $r4;
        boolean $z0;
        java.lang.Object $r5;
        com.dynamixsoftware.printershare.smb.SmbTree $r6;
        java.lang.Throwable $r7;
        null_type varReplacer3100, varReplacer3101;

        nop;

        $r0 := @this: com.dynamixsoftware.printershare.smb.SmbSession;

        $r2 := @parameter0: java.lang.String;

        $r1 := @parameter1: java.lang.String;

        entermonitor $r0;

        if $r2 != null goto label2;

     label1:
        $r2 = "IPC$";

     label2:
        $r3 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: java.util.Vector trees>;

        $r4 = virtualinvoke $r3.<java.util.Vector: java.util.Enumeration elements()>();

     label3:
        $z0 = interfaceinvoke $r4.<java.util.Enumeration: boolean hasMoreElements()>();

        if $z0 == 0 goto label6;

        $r5 = interfaceinvoke $r4.<java.util.Enumeration: java.lang.Object nextElement()>();

        $r6 = (com.dynamixsoftware.printershare.smb.SmbTree) $r5;

        varReplacer3100 = null;

        $z0 = virtualinvoke $r6.<com.dynamixsoftware.printershare.smb.SmbTree: boolean matches(java.lang.String,java.lang.String)>($r2, varReplacer3100);

     label4:
        if $z0 == 0 goto label3;

     label5:
        exitmonitor $r0;

        return $r6;

     label6:
        $r6 = new com.dynamixsoftware.printershare.smb.SmbTree;

        varReplacer3101 = null;

        specialinvoke $r6.<com.dynamixsoftware.printershare.smb.SmbTree: void <init>(com.dynamixsoftware.printershare.smb.SmbSession,java.lang.String,java.lang.String)>($r0, $r2, varReplacer3101);

        $r3 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: java.util.Vector trees>;

        virtualinvoke $r3.<java.util.Vector: void addElement(java.lang.Object)>($r6);

     label7:
        goto label5;

     label8:
        $r7 := @caughtexception;

        exitmonitor $r0;

        throw $r7;

        catch java.lang.Throwable from label1 to label4 with label8;
        catch java.lang.Throwable from label6 to label7 with label8;
    }

    void logoff(boolean)
    {
        com.dynamixsoftware.printershare.smb.SmbSession $r0;
        boolean $z0, $z1;
        com.dynamixsoftware.printershare.smb.SmbComLogoffAndX $r1;
        com.dynamixsoftware.printershare.smb.SmbTransport $r2, $r8;
        int $i0, varReplacer3085, varReplacer3086, varReplacer3090;
        java.util.Vector $r3;
        java.util.Enumeration $r4;
        java.lang.Object $r5;
        com.dynamixsoftware.printershare.smb.SmbTree $r6;
        java.lang.Throwable $r7;
        com.dynamixsoftware.printershare.smb.SmbTransport$ServerData $r9;
        com.dynamixsoftware.printershare.smb.SmbException $r10;
        null_type varReplacer3087, varReplacer3088, varReplacer3089;

        nop;

        $r0 := @this: com.dynamixsoftware.printershare.smb.SmbSession;

        $z0 := @parameter0: boolean;

        $r2 = virtualinvoke $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport()>();

        entermonitor $r2;

     label01:
        $i0 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int connectionState>;

        if $i0 == 2 goto label03;

        exitmonitor $r2;

     label02:
        return;

     label03:
        varReplacer3090 = 3;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int connectionState> = varReplacer3090;

        varReplacer3089 = null;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: java.lang.String netbiosName> = varReplacer3089;

        $r3 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: java.util.Vector trees>;

        $r4 = virtualinvoke $r3.<java.util.Vector: java.util.Enumeration elements()>();

     label04:
        $z1 = interfaceinvoke $r4.<java.util.Enumeration: boolean hasMoreElements()>();

        if $z1 == 0 goto label07;

        $r5 = interfaceinvoke $r4.<java.util.Enumeration: java.lang.Object nextElement()>();

        $r6 = (com.dynamixsoftware.printershare.smb.SmbTree) $r5;

        virtualinvoke $r6.<com.dynamixsoftware.printershare.smb.SmbTree: void treeDisconnect(boolean)>($z0);

        goto label04;

     label05:
        $r7 := @caughtexception;

        exitmonitor $r2;

     label06:
        throw $r7;

     label07:
        if $z0 != 0 goto label12;

     label08:
        $r8 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

        $r9 = $r8.<com.dynamixsoftware.printershare.smb.SmbTransport: com.dynamixsoftware.printershare.smb.SmbTransport$ServerData server>;

        $i0 = $r9.<com.dynamixsoftware.printershare.smb.SmbTransport$ServerData: int security>;

        if $i0 == 0 goto label12;

        $r1 = new com.dynamixsoftware.printershare.smb.SmbComLogoffAndX;

        varReplacer3088 = null;

        specialinvoke $r1.<com.dynamixsoftware.printershare.smb.SmbComLogoffAndX: void <init>(com.dynamixsoftware.printershare.smb.ServerMessageBlock)>(varReplacer3088);

        $i0 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int uid>;

        $r1.<com.dynamixsoftware.printershare.smb.SmbComLogoffAndX: int uid> = $i0;

     label09:
        $r8 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

     label10:
        varReplacer3087 = null;

        virtualinvoke $r8.<com.dynamixsoftware.printershare.smb.SmbTransport: void send(com.dynamixsoftware.printershare.smb.ServerMessageBlock,com.dynamixsoftware.printershare.smb.ServerMessageBlock)>($r1, varReplacer3087);

     label11:
        varReplacer3085 = 0;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int uid> = varReplacer3085;

     label12:
        varReplacer3086 = 0;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int connectionState> = varReplacer3086;

        $r8 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

        virtualinvoke $r8.<java.lang.Object: void notifyAll()>();

        exitmonitor $r2;

     label13:
        return;

     label14:
        $r10 := @caughtexception;

        goto label11;

        catch java.lang.Throwable from label01 to label02 with label05;
        catch java.lang.Throwable from label03 to label06 with label05;
        catch java.lang.Throwable from label08 to label09 with label05;
        catch com.dynamixsoftware.printershare.smb.SmbException from label10 to label11 with label14;
        catch java.lang.Throwable from label09 to label11 with label05;
        catch java.lang.Throwable from label11 to label13 with label05;
    }

    boolean matches(com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication)
    {
        com.dynamixsoftware.printershare.smb.SmbSession $r0;
        com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication $r1, $r2;
        boolean $z0;
        int varReplacer3083, varReplacer3084;

        nop;

        $r0 := @this: com.dynamixsoftware.printershare.smb.SmbSession;

        $r1 := @parameter0: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication;

        $r2 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

        if $r2 == $r1 goto label1;

        $r2 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

        $z0 = virtualinvoke $r2.<com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication: boolean equals(java.lang.Object)>($r1);

        if $z0 == 0 goto label2;

     label1:
        varReplacer3084 = 1;

        return varReplacer3084;

     label2:
        varReplacer3083 = 0;

        return varReplacer3083;
    }

    void send(com.dynamixsoftware.printershare.smb.ServerMessageBlock, com.dynamixsoftware.printershare.smb.ServerMessageBlock) throws com.dynamixsoftware.printershare.smb.SmbException
    {
        com.dynamixsoftware.printershare.smb.SmbSession $r0;
        com.dynamixsoftware.printershare.smb.ServerMessageBlock $r1, $r2;
        com.dynamixsoftware.printershare.smb.SmbException $r3;
        com.dynamixsoftware.printershare.smb.SmbTransport $r4, $r9;
        long $l0;
        boolean $z0;
        com.dynamixsoftware.printershare.smb.SmbComTreeConnectAndX $r5;
        java.lang.String $r6, varReplacer3132, varReplacer3136, varReplacer3137;
        java.lang.StringBuilder $r7;
        int $i1, varReplacer3134, varReplacer3135;
        com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication $r8;
        java.lang.Throwable $r10;
        null_type varReplacer3133;

        nop;

        $r0 := @this: com.dynamixsoftware.printershare.smb.SmbSession;

        $r1 := @parameter0: com.dynamixsoftware.printershare.smb.ServerMessageBlock;

        $r2 := @parameter1: com.dynamixsoftware.printershare.smb.ServerMessageBlock;

        $r4 = virtualinvoke $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport()>();

        entermonitor $r4;

        if $r2 == null goto label02;

     label01:
        varReplacer3135 = 0;

        $r2.<com.dynamixsoftware.printershare.smb.ServerMessageBlock: boolean received> = varReplacer3135;

     label02:
        $l0 = staticinvoke <java.lang.System: long currentTimeMillis()>();

        $l0 = $l0 + 15000L;

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: long expiration> = $l0;

        specialinvoke $r0.<com.dynamixsoftware.printershare.smb.SmbSession: void sessionSetup(com.dynamixsoftware.printershare.smb.ServerMessageBlock,com.dynamixsoftware.printershare.smb.ServerMessageBlock)>($r1, $r2);

        if $r2 == null goto label04;

        $z0 = $r2.<com.dynamixsoftware.printershare.smb.ServerMessageBlock: boolean received>;

        if $z0 == 0 goto label04;

        exitmonitor $r4;

     label03:
        return;

     label04:
        $z0 = $r1 instanceof com.dynamixsoftware.printershare.smb.SmbComTreeConnectAndX;

        if $z0 == 0 goto label05;

        $r5 = (com.dynamixsoftware.printershare.smb.SmbComTreeConnectAndX) $r1;

        $r6 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: java.lang.String netbiosName>;

        if $r6 == null goto label05;

        $r6 = $r5.<com.dynamixsoftware.printershare.smb.SmbComTreeConnectAndX: java.lang.String path>;

        varReplacer3136 = "\\IPC$";

        $z0 = virtualinvoke $r6.<java.lang.String: boolean endsWith(java.lang.String)>(varReplacer3136);

        if $z0 == 0 goto label05;

        $r7 = new java.lang.StringBuilder;

        specialinvoke $r7.<java.lang.StringBuilder: void <init>()>();

        varReplacer3137 = "\\\\";

        $r7 = virtualinvoke $r7.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(varReplacer3137);

        $r6 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: java.lang.String netbiosName>;

        $r7 = virtualinvoke $r7.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>($r6);

        varReplacer3132 = "\\IPC$";

        $r7 = virtualinvoke $r7.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(varReplacer3132);

        $r6 = virtualinvoke $r7.<java.lang.StringBuilder: java.lang.String toString()>();

        $r5.<com.dynamixsoftware.printershare.smb.SmbComTreeConnectAndX: java.lang.String path> = $r6;

     label05:
        $i1 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int uid>;

        $r1.<com.dynamixsoftware.printershare.smb.ServerMessageBlock: int uid> = $i1;

        $r8 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

        $r1.<com.dynamixsoftware.printershare.smb.ServerMessageBlock: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth> = $r8;

     label06:
        $r9 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

     label07:
        virtualinvoke $r9.<com.dynamixsoftware.printershare.smb.SmbTransport: void send(com.dynamixsoftware.printershare.smb.ServerMessageBlock,com.dynamixsoftware.printershare.smb.ServerMessageBlock)>($r1, $r2);

     label08:
        exitmonitor $r4;

     label09:
        return;

     label10:
        $r10 := @caughtexception;

        exitmonitor $r4;

     label11:
        throw $r10;

     label12:
        $r3 := @caughtexception;

     label13:
        $z0 = $r1 instanceof com.dynamixsoftware.printershare.smb.SmbComTreeConnectAndX;

        if $z0 == 0 goto label14;

        varReplacer3134 = 1;

        virtualinvoke $r0.<com.dynamixsoftware.printershare.smb.SmbSession: void logoff(boolean)>(varReplacer3134);

     label14:
        varReplacer3133 = null;

        $r1.<com.dynamixsoftware.printershare.smb.ServerMessageBlock: com.dynamixsoftware.printershare.smb.SigningDigest digest> = varReplacer3133;

        throw $r3;

     label15:
        nop;

        catch java.lang.Throwable from label01 to label03 with label10;
        catch java.lang.Throwable from label04 to label06 with label10;
        catch com.dynamixsoftware.printershare.smb.SmbException from label07 to label08 with label12;
        catch java.lang.Throwable from label06 to label08 with label10;
        catch java.lang.Throwable from label08 to label09 with label10;
        catch java.lang.Throwable from label10 to label11 with label10;
        catch java.lang.Throwable from label13 to label15 with label10;
    }

    public java.lang.String toString()
    {
        com.dynamixsoftware.printershare.smb.SmbSession $r0;
        java.lang.StringBuilder $r1;
        com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication $r2;
        java.lang.String $r3;
        int $i0;

        $r0 := @this: com.dynamixsoftware.printershare.smb.SmbSession;

        $r1 = new java.lang.StringBuilder;

        specialinvoke $r1.<java.lang.StringBuilder: void <init>()>();

        $r1 = virtualinvoke $r1.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>("SmbSession[accountName=");

        $r2 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

        $r3 = $r2.<com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication: java.lang.String username>;

        $r1 = virtualinvoke $r1.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>($r3);

        $r1 = virtualinvoke $r1.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(",primaryDomain=");

        $r2 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication auth>;

        $r3 = $r2.<com.dynamixsoftware.printershare.smb.NtlmPasswordAuthentication: java.lang.String domain>;

        $r1 = virtualinvoke $r1.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>($r3);

        $r1 = virtualinvoke $r1.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(",uid=");

        $i0 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int uid>;

        $r1 = virtualinvoke $r1.<java.lang.StringBuilder: java.lang.StringBuilder append(int)>($i0);

        $r1 = virtualinvoke $r1.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>(",connectionState=");

        $i0 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int connectionState>;

        $r1 = virtualinvoke $r1.<java.lang.StringBuilder: java.lang.StringBuilder append(int)>($i0);

        $r1 = virtualinvoke $r1.<java.lang.StringBuilder: java.lang.StringBuilder append(java.lang.String)>("]");

        $r3 = virtualinvoke $r1.<java.lang.StringBuilder: java.lang.String toString()>();

        return $r3;
    }

    com.dynamixsoftware.printershare.smb.SmbTransport transport()
    {
        com.dynamixsoftware.printershare.smb.SmbSession $r0;
        int $i0, $i1;
        java.net.InetAddress $r1;
        com.dynamixsoftware.printershare.smb.SmbTransport $r2;
        com.dynamixsoftware.printershare.smb.UniAddress $r3;
        java.lang.Throwable $r4;
        null_type varReplacer3099;

        nop;

        $r0 := @this: com.dynamixsoftware.printershare.smb.SmbSession;

        entermonitor $r0;

     label1:
        $r2 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

        if $r2 != null goto label2;

        $r3 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.UniAddress address>;

        $i0 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int port>;

        $r1 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: java.net.InetAddress localAddr>;

        $i1 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: int localPort>;

        varReplacer3099 = null;

        $r2 = staticinvoke <com.dynamixsoftware.printershare.smb.SmbTransport: com.dynamixsoftware.printershare.smb.SmbTransport getSmbTransport(com.dynamixsoftware.printershare.smb.UniAddress,int,java.net.InetAddress,int,java.lang.String)>($r3, $i0, $r1, $i1, varReplacer3099);

        $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport> = $r2;

     label2:
        $r2 = $r0.<com.dynamixsoftware.printershare.smb.SmbSession: com.dynamixsoftware.printershare.smb.SmbTransport transport>;

     label3:
        exitmonitor $r0;

        return $r2;

     label4:
        $r4 := @caughtexception;

        exitmonitor $r0;

        throw $r4;

        catch java.lang.Throwable from label1 to label3 with label4;
    }
}
